{% comment %}
------------------------------------------------------------------------------
  Snippet: Product notify me button
------------------------------------------------------------------------------
{% endcomment %}


{%- assign notify_me_button_label = block.settings.notify_me_button_label -%}
{%- assign notify_me_button_icon = block.settings.notify_me_button_icon -%}
{%- assign notify_me_button_icon_alt = block.settings.notify_me_button_icon.alt -%}
{%- assign notify_me_form_heading = block.settings.notify_me_form_heading -%}
{%- assign notify_me_form_email_placeholder = block.settings.notify_me_form_email_placeholder -%}
{%- assign notify_me_form_submit_button_label = block.settings.notify_me_form_submit_button_label -%}
{%- assign notify_me_form_success_message = block.settings.notify_me_form_success_message -%}
{%- assign close_modal = 'general.accessibility.close_modal' | t -%}
{%- assign product_notify_me_message = 'products.product.product_notify_me_message' | t -%}
{%- assign id = section_id -%}

{%- if notify_me_button_label != blank and
	   notify_me_form_email_placeholder != blank and
	   notify_me_form_submit_button_label != blank and
	   notify_me_form_success_message != blank and
	   notify_me_form_heading != blank and
	   product_notify_me_message != blank and
	   close_modal != blank
-%}
	{%- capture styles -%}
		--offset-top-desktop: {{ block.settings.offset_top_desktop }}px; {{-  -}}
		--offset-bottom-desktop: {{ block.settings.offset_bottom_desktop }}px; {{-  -}}
		--offset-top-mobile: {{ block.settings.offset_top_mobile }}px; {{-  -}}
		--offset-bottom-mobile: {{ block.settings.offset_bottom_mobile }}px;
	{%- endcapture -%}

	<div class="product-form__button-link-container js-notify-me-button-container" style="{{ styles }}">
		<button class="product-notify-me-button button-link button-link--with-icon focus-visible-outline js-notify-me-button"
				type="button"
				data-target="ProductNotifyMePopup-{{- id -}}"
				data-js-toggle="ProductNotifyMePopup-{{- id -}}"

		>
			{%- if notify_me_button_icon != blank -%}
				{%- capture img_focal -%}
					--img-desktop-pos: {{ notify_me_button_icon.presentation.focal_point }};
				{%- endcapture -%}

				<img class="button-link__icon"
					 src="{{ notify_me_button_icon | image_url: width: 24, height: 24 }}"
					 srcset="{{ notify_me_button_icon | image_url: width: 24, height: 24 }} 1x,
						 {{ notify_me_button_icon | image_url: width: 48, height: 48 }} 2x"
					 style="{{ img_focal }}"
					 alt="{{ notify_me_button_icon_alt | escape }}"
					 aria-hidden="true"
					 loading="lazy"
				>
			{%- endif -%}

			<span class="button-link__text">{{ notify_me_button_label }}</span>
		</button>
	</div>
{%- endif -%}
