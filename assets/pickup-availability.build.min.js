customElements.get("pickup-availability")||customElements.define("pickup-availability",class extends HTMLElement{constructor(){if(super(),!!this.hasAttribute("available")){this.errorHtml=this.querySelector("template").content.firstElementChild.cloneNode(!0),this.onClickRefreshList=this.onClickRefreshList.bind(this),this.fetchAvailability=this.fetchAvailability.bind(this),this.initEventListeners();try{this.fetchAvailability(this.dataset.variantId)}catch{}}}initEventListeners(){document.addEventListener("theme:all:loaded",()=>{this.fetchAvailability(this.dataset.variantId)})}fetchAvailability(r){const s=this.dataset.sectionId;let e=this.dataset.rootUrl;e.endsWith("/")||(e=e+"/");const i=`${e}variants/${r}/?section_id=pickup-availability`;fetch(i).then(t=>t.text()).then(t=>{const a=new DOMParser().parseFromString(t,"text/html").querySelector(".shopify-section");this.renderPreview(a,s)}).catch(()=>{const t=this.querySelector("button");t&&t.removeEventListener("click",this.onClickRefreshList),this.renderError()})}onClickRefreshList(){this.fetchAvailability(this.dataset.variantId)}renderError(){this.innerHTML="",this.appendChild(this.errorHtml),this.querySelector("button").addEventListener("click",this.onClickRefreshList)}renderPreview(r,s){const e=r.querySelector("pickup-availability-preview");if(!e){this.innerHTML="",this.removeAttribute("available");return}const i=e.querySelector("[data-js-toggle-selector]");i&&(i.dataset.target+=`__${s}`,i.dataset.jsToggle=i.dataset.target),this.innerHTML=e.outerHTML,this.setAttribute("available","");const t=r.querySelector("pickup-availability-drawer");if(t){t.id+=`__${s}`;const a=t.querySelector("[data-js-toggle-selector]");a&&(a.dataset.target+=`__${s}`,a.dataset.jsToggle=a.dataset.target);const l=document.querySelector(`pickup-availability-drawer#productAvailability-pickup-availability__${this.dataset.sectionId}`);l?l.outerHTML=t.outerHTML:document.body.appendChild(t)}}});customElements.get("pickup-availability-drawer")||customElements.define("pickup-availability-drawer",class extends HTMLElement{constructor(){super(),window.themeCore.EventBus.emit(`pickup-availability-drawer:${this.id}:loaded`)}});
