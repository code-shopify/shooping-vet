const _=()=>{const L=window.themeCore.utils.debounce,S=window.themeCore.utils.cssClasses,s={form:".js-predictive-search-form",input:".js-predictive-search-input",resultContainer:".js-predictive-search-result",searchType:"input[name='type']",applyButton:".js-predictive-search-apply-button",resultRow:".js-predictive-search-result-row",tabsButton:".js-predictive-search-tabs-button",preloader:".js-preloader",searchDrawer:"#headerDrawerSearch",resultWrapper:".js-predictive-search-results",footer:".js-predictive-search-footer",activeTab:".js-predictive-search-tabs-button.is-active",tabsWrapper:".js-predictive-search-tabs-wrapper",tabsItem:".js-predictive-search-tabs-item"},i={disabled:"disabled",id:"id",dataId:"data-id",ariaExpanded:"aria-expanded",ariaHidden:"aria-hidden"},c={visuallyHidden:"visually-hidden",...S},C=8;let p={};const u=document.querySelector(s.preloader),l=document.querySelector(s.footer),f=document.querySelector(s.resultContainer)?document.querySelector(s.resultContainer).innerHTML:null,v=window.Shopify.routes.root;async function g(n){const e=n.target.closest(s.input),r=document.querySelector(s.searchDrawer),t=document.querySelector(s.resultContainer),o=document.querySelector(s.applyButton);if(!r||!e||!t||!o)return;const d=e.value.trim();if(!d.length){o.setAttribute(i.disabled,i.disabled),o.setAttribute(i.ariaHidden,"true"),h(t),l.classList.add(c.hidden),t.innerHTML=f;return}if(A(),p[d]){w(p[d],t,o),b(),l.classList.remove(c.hidden);return}const m=await R(d),a=new DOMParser().parseFromString(await m.text(),"text/html");p[d]=a,w(a,t,o),b(),l.classList.remove(c.hidden)}function T(){const n=document.querySelector(s.applyButton),e=document.querySelector(s.resultContainer);n.setAttribute(i.disabled,i.disabled),n.setAttribute(i.ariaHidden,"true"),h(e),e.innerHTML=f,l.classList.add(c.hidden)}function A(){u&&u.classList.add(c.active)}function b(){u&&u.classList.remove(c.active)}function w(n,e,r){h(e),r.removeAttribute(i.disabled),r.removeAttribute(i.ariaHidden);const t=n.querySelector(s.resultWrapper);if(!t){r.setAttribute(i.disabled,i.disabled),r.setAttribute(i.ariaHidden,"true"),H(e);return}e.innerHTML=t.innerHTML,document.addEventListener("click",q)}function q(n){const e=[...document.querySelectorAll(s.tabsButton)],r=[...document.querySelectorAll(s.resultRow)],t=n.target.closest(s.tabsButton);if(!t||!e.length||!r.length)return;e.forEach(a=>{a.classList.remove(c.active),a.setAttribute(i.ariaExpanded,!1)}),t.classList.add(c.active),t.setAttribute(i.ariaExpanded,!0),r.forEach(a=>{a.classList.remove(c.active),a.classList.add(c.visuallyHidden)}),r.filter(a=>a.dataset.id===t.dataset.id).forEach(a=>{a.classList.add(c.active),a.classList.remove(c.visuallyHidden)});const o=t.closest(s.tabsWrapper),d=o.offsetLeft+(parseInt(window.getComputedStyle(o).paddingLeft)||0),m=t.offsetLeft;o.scrollTo({left:m-d,behavior:"smooth"})}function H(n){var r,t,o;const e=`
				<p class="h4 predictive-search__result-empty">
					${((o=(t=(r=window.themeCore)==null?void 0:r.objects)==null?void 0:t.settings)==null?void 0:o.predictive_search_no_result)||window.themeCore.translations.get("general.predictive_search.no_results")}
				</p>
			`;n.innerHTML+=e}async function R(n){const e=document.querySelector(s.searchType);if(!e)return;const r=`${encodeURIComponent("resources[type]")}=${e.value}`,t=`${encodeURIComponent("resources[limit]")}=${C}`,o=`${v}search/suggest?q=${encodeURIComponent(n)}&${r}&${t}&section_id=predictive-search`;return await fetch(o)}function h(n){n.innerHTML=""}function E(n){const e=n.target.closest(s.form);if(!e)return;n.preventDefault();const r=e.querySelector(s.input).value.trim();r.length&&j(r)}function j(n){const e=document.querySelector(s.activeTab);if(!e)return;const r=encodeURI(n),t=`${v}search/?type=${e.getAttribute(i.dataId)}&options%5Bprefix%5D=last&q=${r}`;window.location.replace(t)}function $(){document.addEventListener("input",L(g,200,!1)),document.addEventListener("reset",T),document.addEventListener("submit",E)}return Object.freeze({init:$})},y=()=>{window.themeCore.PredictiveSearch=window.themeCore.PredictiveSearch||_(),window.themeCore.utils.register(window.themeCore.PredictiveSearch,"predictive-search")};window.themeCore&&window.themeCore.loaded?y():document.addEventListener("theme:all:loaded",y,{once:!0});
