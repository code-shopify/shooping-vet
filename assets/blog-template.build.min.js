const x=()=>{const m=window.themeCore.utils.cssClasses,S=window.themeCore.utils.Swiper,n={section:".js-blog",slider:".js-blog-slider",grid:".js-blog-grid",filter:".js-filter",filterLink:".js-filter-link",resetLink:".js-filter-reset",pagination:".js-pagination",paginationLink:".js-pagination-link",infiniteScroll:".js-infinite-scroll",lazyLoad:".js-lazy-load",pageLoader:".js-page-preloader"},o={noEvents:"no-events",...m};let s=document.querySelector(n.section),l=document.querySelector(n.pageLoader),i={grid:s.querySelector(n.grid),slider:s.querySelector(n.slider),filter:s.querySelector(n.filter),filterLinks:[...s.querySelectorAll(n.filterLink)],resetLink:s.querySelector(n.resetLink),pagination:s.querySelector(n.pagination),lazyLoad:s.querySelector(n.lazyLoad),infiniteScroll:s.querySelector(n.infiniteScroll)},c=null;async function h(t){const e=t.target.closest(n.paginationLink);e&&(t.preventDefault(),e.classList.add(o.noEvents),window.scrollTo(0,0),await d(e.href),window.history.pushState({},null,e.href))}async function b(t){const e=t.target.closest(n.filterLink),r=t.target.closest(n.resetLink);if(!e&&!r)return;t.preventDefault();const a=i.filterLinks.find(f=>f.classList.contains(o.active))||i.resetLink;if(e){if(e.classList.add(o.noEvents),e.classList.contains(o.active)){e.classList.remove(o.active),await g(),e.classList.remove(o.noEvents);return}a.classList.remove(o.active),e.classList.add(o.active),e.scrollIntoView({behavior:"smooth",block:"nearest",inline:"center"}),await d(e.href),window.history.pushState({},null,e.href),e.classList.remove(o.noEvents),i.resetLink.setAttribute("tabindex","0");return}r&&!r.classList.contains(o.active)&&(a.classList.remove(o.active),r.scrollIntoView({behavior:"smooth",block:"nearest",inline:"center"}),await g())}async function q(t){const e=t.target.closest(n.lazyLoad);if(!e)return;e.classList.add(o.noEvents);const r=window.location.origin+e.dataset.nextUrl;await k(r)}async function g(){i.resetLink.classList.add(o.noEvents,o.active),i.resetLink.setAttribute("tabindex","-1"),await d(i.resetLink.href),window.history.pushState({},null,i.resetLink.href),i.resetLink.classList.remove(o.noEvents)}async function d(t){i.grid.ariaBusy="true",l.classList.add(o.active);const e=y(t,s.id),r=await v(e);E(r),window.themeCore.LazyLoadImages.init(),l.classList.remove(o.active),i.grid.ariaBusy="false"}function y(t,e=s.id){const r=new URL(t);return r.searchParams.set("section_id",e),r.toString()}async function v(t){const r=await(await fetch(t)).text(),a=new DOMParser().parseFromString(r,"text/html");return{grid:a.querySelector(n.grid),pagination:a.querySelector(n.pagination),infiniteScroll:a.querySelector(n.infiniteScroll),lazyLoad:a.querySelector(n.lazyLoad)}}function E({grid:t,pagination:e,infiniteScroll:r,lazyLoad:a}){!t&&!e&&!r&&!a||(i.grid.innerHTML=t.innerHTML,L(i.infiniteScroll),p({pagination:e,infiniteScroll:r,lazyLoad:a}),r&&u(r))}function p(t){if(!(!t||!Object.keys(t).length))for(const e in t)i[e]&&(i[e].replaceWith(t[e]),i[e]=t[e])}async function j(){const t=window.location.href,e=i.filterLinks.find(a=>a.classList.contains(o.active))||i.resetLink,r=i.filterLinks.find(a=>t.includes(a.href))||i.resetLink;e!==r&&e.classList.remove(o.active),await d(t),e!==r&&r.classList.add(o.active)}async function C(t){t&&new S(t,{slidesPerView:1,spaceBetween:16,navigation:{nextEl:".js-blog-slider-next",prevEl:".js-blog-slider-prev"},pagination:{el:".js-blog-slider-pagination",clickable:!0,bulletElement:"button"}})}function u(t){c=new IntersectionObserver(e=>{e.forEach(async r=>{r.isIntersecting&&await T(t)})},{threshold:.25}),c.observe(t)}function L(t){t&&c&&c.unobserve(t)}async function T(t){L(t);const e=window.location.origin+t.dataset.nextUrl;await k(e)}async function k(t){l.classList.add(o.active);const e=y(t,s.id),{grid:r,infiniteScroll:a,lazyLoad:f}=await v(e);i.grid.insertAdjacentHTML("beforeend",r.innerHTML),L(i.infiniteScroll),p({infiniteScroll:a,lazyLoad:f}),a&&u(a),window.themeCore.LazyLoadImages.init(),l.classList.remove(o.active)}function z(){s=document.querySelector(n.section),l=document.querySelector(n.pageLoader),i={grid:s.querySelector(n.grid),slider:s.querySelector(n.slider),filter:s.querySelector(n.filter),filterLinks:[...s.querySelectorAll(n.filterLink)],resetLink:s.querySelector(n.resetLink),pagination:s.querySelector(n.pagination),lazyLoad:s.querySelector(n.lazyLoad),infiniteScroll:s.querySelector(n.infiniteScroll)},i.pagination&&s.addEventListener("click",h),i.filter&&s.addEventListener("click",b),i.lazyLoad&&s.addEventListener("click",q),(i.filter||i.pagination)&&window.addEventListener("popstate",j),i.infiniteScroll&&u(i.infiniteScroll),i.slider&&C(i.slider)}return Object.freeze({init:z})},w=()=>{window.themeCore.BlogTemplate=window.themeCore.BlogTemplate||x(),window.themeCore.utils.register(window.themeCore.BlogTemplate,"blog-template")};window.themeCore&&window.themeCore.loaded||window.themeCore&&window.themeCore.loaded?w():document.addEventListener("theme:all:loaded",w,{once:!0});
