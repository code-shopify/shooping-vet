const se={iframe:"iframe"};async function oe(e){const a=window.themeCore.utils.Video;return a(e).init()}function re(e){const a=window.themeCore.utils.VIDEO_TYPES;e.filter(l=>l.type===a.vimeo).forEach(l=>l.player.on("loaded",()=>ne(l.videoWrapper)))}function ne(e){const a=e.querySelector(se.iframe);a&&a.setAttribute("tabindex","-1")}function ae(e,a){const l=window.themeCore.utils.VIDEO_TYPES;switch(a){case l.html:{e.play();break}case l.vimeo:{e.play();break}case l.youtube:{e.mute(),e.playVideo();break}default:return}}function le(e,a){const l=window.themeCore.utils.VIDEO_TYPES;switch(a){case l.html:{e.pause();break}case l.vimeo:{e.pause();break}case l.youtube:{e.pauseVideo();break}default:return}}const S=e=>{const a={videoContainer:e,options:{youtube:{autoplay:0,controls:0,showinfo:0,rel:0,playsinline:1,loop:1},vimeo:{controls:!1,loop:!0,muted:!0,portrait:!1,title:!1,keyboard:!1,byline:!1,autopause:!1}}};async function l(){const f=await oe(a);if(f&&f.length)return re(f),f}return Object.freeze({init:l,playVideo:ae,pauseVideo:le})},de=async e=>{const a=window.themeCore.utils.Swiper,l=window.themeCore.utils.swiperA11y,f=window.themeCore.utils.swiperPagination,B=await window.themeCore.utils.getExternalUtil("swiperAutoplay"),H=await window.themeCore.utils.getExternalUtil("swiperParallax"),U=await window.themeCore.utils.getExternalUtil("swiperEffectFade"),J=await window.themeCore.utils.getExternalUtil("swiperEffectFlip"),W=await window.themeCore.utils.getExternalUtil("swiperEffectCreative");a.use([f,B,H,U,J,W,l]);const s={slider:".js-slider",sliderThumbnails:".js-slider-thumbnails",slide:".swiper-slide",activeSlide:".swiper-slide-active",sliderSettings:".js-slider-settings",progressbar:".js-progressbar",video:".js-video",videoPosterDesktop:".js-video-poster-desktop",videoPosterMobile:".js-video-poster-mobile",playButton:".js-video-button-play",pauseButton:".js-video-button-pause",showButtons:"[data-show-button=true]",currentVideo:".swiper-slide.swiper-slide-active .js-video, .js-slider:not(.swiper) .js-video",button:".js-button",iframe:"iframe",currentVimeoVideo:'.swiper-slide.swiper-slide-active .js-video[data-vimeo-initialized="true"] iframe, .js-slider:not(.swiper) .js-video [data-vimeo-initialized="true"] iframe'},p={active:"is-active",swiperSlideActive:"swiper-slide-active"},P=window.matchMedia("(max-width: 767px)"),h=e.querySelector(s.slider),j=e.querySelector(s.sliderSettings),L=e.querySelector(s.sliderThumbnails),m=e.querySelector(s.pauseButton),v=e.querySelector(s.playButton),G=await S(e).playVideo,k=await S(e).pauseVideo;let g,T,u,d,q,y,x;h&&(g=[...h.querySelectorAll(s.slide)]);async function K(){if(d=R(),!d)return;let t={};if(L){const n=L.dataset.slidesPerView;q=new a(L,{slidesPerView:n,spaceBetween:8,watchSlidesProgress:!0,direction:"vertical"}),t={thumbs:{swiper:q}},q.$el.on("keydown",w=>{if(w.keyCode!==13&&w.keyCode!==32)return;const c=w.target.dataset.slideIndex;u&&u.slideToLoop(c)})}u=new a(h,{...d,...t});const i=e.querySelector(s.progressbar);y=i&&i.animate([{width:"0%"},{width:"100%"}],{fill:"forwards",easing:"linear",duration:d.autoplay.delay+d.speed});const r=e.querySelector(s.activeSlide);if(r){M(r);let n=h.querySelectorAll(".js-need-animate-after-load");n.length&&n.forEach(function(w){w.classList.add("need-animate")})}let o=await S(e).init();o&&o.length&&(P.addEventListener("change",()=>{D(o)}),D(o),e.addEventListener("click",n=>z(n,o)),u.on("slidesLengthChange",async function(){o=await S(e).init()}),window.addEventListener("resize",I)),u.on("slideChange",function(n){window.themeCore.LazyLoadImages.init();const w=e.querySelector(`${s.slide}:nth-child(${n.activeIndex+1}`);if(M(w),!o||!o.length)return;const c=[...e.querySelectorAll(`${s.slide}:nth-child(${n.activeIndex+1}) ${s.video}`)].filter(V=>getComputedStyle(V).getPropertyValue("display")!=="none"),C=!!e.querySelector(`${s.slide}:nth-child(${n.activeIndex+1}) ${s.showButtons}`);E(C,c),$(o,c),c&&c.length&&c.forEach(V=>{if(!V.dataset.vimeoInitialized)return;const _=V.querySelector(s.iframe);_&&Y(_)})}),d&&d.autoplay&&d.autoplay.delay&&(A(!0),u.on("slideChangeTransitionEnd",()=>{A(!0)})),Q()}function A(t){if(t){if(x)return;u.autoplay.start(),ie(),y&&(y.currentTime=0,y.play())}else u.autoplay.stop(),clearTimeout(T),y&&(y.pause(),y.currentTime=0)}function O(t){x=t,A(!x)}function Q(){if(!window.Shopify.designMode)return null;window.themeCore.EventBus.listen("shopify:block:select",t=>{if(t.detail.sectionId!==e.id||!t.target.dataset.hasOwnProperty("slideIndex"))return null;u&&u.initialized&&(u.slideToLoop(t.target.dataset.slideIndex),d&&d.autoplay&&d.autoplay.delay&&O(!0))}),window.themeCore.EventBus.listen("shopify:block:deselect",t=>{if(t.detail.sectionId!==e.id||!t.target.dataset.hasOwnProperty("slideIndex"))return null;u&&u.initialized&&d&&d.autoplay&&d.autoplay.delay&&O(!1)})}function R(){try{return JSON.parse(j.textContent)}catch{return null}}function X(){if(h&&j){N(K);return}else g&&g.length===1&&g[0].classList.add(p.swiperSlideActive);N(ee)}function $(t,i,r){const o=P.matches?s.videoPosterMobile:s.videoPosterDesktop;t&&t.forEach(n=>{let w=i.some(c=>n.videoWrapper===c&&(JSON.parse(c.dataset.autoplay)||r));if(i&&i.length&&w){i.forEach(c=>{if(n.videoWrapper===c&&(JSON.parse(c.dataset.autoplay)||r)){const C=c.closest(s.slide).querySelector(o);G(n.player,n.type),C&&setTimeout(()=>C.remove(),200)}});return}k(n.player,n.type)})}function b(t,i){const r=[...e.querySelectorAll(s.currentVideo)].filter(o=>getComputedStyle(o).getPropertyValue("display")!=="none");$(t,r,i)}function Z(t){t.forEach(i=>{k(i.player,i.type)})}async function ee(){let t=await S(e).init();const i=!!e.querySelector(`${s.showButtons}`),r=[...e.querySelectorAll(`${s.video}`)].filter(o=>getComputedStyle(o).getPropertyValue("display")!=="none");E(i,r),e.addEventListener("click",o=>z(o,t)),b(t),window.addEventListener("resize",I),P.addEventListener("change",()=>{b(t),E(i,r)})}function E(t,i){if(i=i||[...e.querySelectorAll(s.currentVideo)].filter(r=>getComputedStyle(r).getPropertyValue("display")!=="none"),i&&i.length&&!JSON.parse(i[0].dataset.autoplay)){if(m.classList.remove(p.active),t){v.classList.add(p.active);return}v.classList.remove(p.active);return}if(v.classList.remove(p.active),t){m.classList.add(p.active);return}m.classList.remove(p.active)}function z(t,i){if(t.target.closest(s.pauseButton)){m.classList.remove(p.active),v.classList.add(p.active),Z(i);return}t.target.closest(s.playButton)&&(m.classList.add(p.active),v.classList.remove(p.active),b(i,!0))}function D(t){const i=!!e.querySelector(`${s.slide}${s.activeSlide} ${s.showButtons}`);E(i),b(t)}function M(t){[...e.querySelectorAll(s.slide)].forEach(r=>{const o=r.querySelectorAll(s.button);if(o.length){if(r===t){o.forEach(n=>n.setAttribute("tabindex",0));return}o.forEach(n=>n.setAttribute("tabindex",-1))}})}function N(t){new IntersectionObserver((r,o)=>{r.forEach(n=>{n.isIntersecting&&(t(),o.unobserve(e))})},{threshold:.3}).observe(e),te()}function Y(t){if(!t)return;const i=t.offsetHeight,r=window.innerWidth*.5625;if(r>=i){t.style.setProperty("--scale",1);return}t.style.setProperty("--scale",i/r)}function I(){const t=[...e.querySelectorAll(s.currentVimeoVideo)].find(i=>getComputedStyle(i).getPropertyValue("display")!=="none");t&&Y(t)}function te(){new MutationObserver(i=>{i.forEach(r=>{r.target.dataset.vimeoInitialized&&I()})}).observe(e,{attributes:!0,childList:!0,subtree:!0})}function ie(){clearTimeout(T),T=setTimeout(()=>{u.slideNext(d.speed)},d.autoplay.delay)}return Object.freeze({init:X})},ue={section:".js-slideshow",videoContainer:".js-videos"},ce=()=>{async function e(a){[...document.querySelectorAll(ue.section)].filter(f=>!a||a===f.id).forEach(async f=>{(await de(f)).init()})}return Object.freeze({init:e})},F=()=>{window.themeCore.Slideshow=window.themeCore.Slideshow||ce(),window.themeCore.utils.register(window.themeCore.Slideshow,"slideshow")};window.themeCore&&window.themeCore.loaded?F():document.addEventListener("theme:all:loaded",F,{once:!0});
