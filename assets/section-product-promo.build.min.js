const i={section:".js-product-promo",buttonQuickView:".js-product-promo-quick-view-button",buttonClose:".js-product-promo-quick-view-button-close",main:"#MainContent"},E=()=>{const u=window.themeCore.utils.setCookie,d=window.themeCore.utils.getCookie,m=window.themeCore.utils.cssClasses,w=6e3;let e,r,n,c;function C(){if(e=document.querySelector(i.section),!e)return!1;r=e.dataset.handle,n=e.dataset.variantId,c=e.dataset.variantCount,setTimeout(P,w),p()}function l(){if(!e.hasAttribute("data-cookie-time"))return;let o=e.dataset.cookieTime*24*60*60;u("product_promo","1",{"max-age":o})}function p(){e.addEventListener("click",t=>{if(t.target.closest(i.buttonQuickView)){h(),a();return}t.target.closest(i.buttonClose)&&a()})}function h(){c>1?v():k()}async function k(){try{await window.themeCore.CartApi.makeRequest(window.themeCore.CartApi.actions.ADD_TO_CART,{id:n,quantity:1}),await window.themeCore.CartApi.makeRequest(window.themeCore.CartApi.actions.GET_CART)}catch(t){f(t)}}function f(t){const o=window.themeCore.CartNotificationError;o.addNotification(t.description),o.open()}function v(){const t=document.querySelector(i.main);window.themeCore.EventBus.emit("product-card:quick-view:clicked",{productHandle:r,variant:n,showDescription:!0,focusTarget:t})}function a(){l(),e.remove()}function P(){d("product_promo")||e.classList.remove(m.hidden)}return Object.freeze({init:C})},s=()=>{window.themeCore.ProductPromo=window.themeCore.ProductPromo||E(),window.themeCore.utils.register(window.themeCore.ProductPromo,"product-promo-popup")};window.themeCore&&window.themeCore.loaded?s():document.addEventListener("theme:all:loaded",s,{once:!0});
